<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    
    <title>pb.bank - soruce documentation: Source: adapters/MovementsAdapter/MovementsAdapter-impl.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    
	<!-- link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css" -->
	

    <link rel="stylesheet" type="text/css" media="screen" href="../stylesheets/stylesheet.css">

    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
</head>

<body>
	
    <!-- HEADER -->
    <div id="header_wrap" class="outer">
        <header class="inner">
          <a id="forkme_banner" href="https://github.com/paolob67/pb.bank">View on GitHub</a>

          <h1 id="project_title">pb.bank</h1>
          <h2 id="project_tagline">A starter online banking application built with Worklight, Angular and Bluemix services</h2>
            <section id="navigation">
              <table>
                <tr>
                  <td><a href="../index.html">Intro and info</font></strong></td>
                  <td><a href="../overview.html">Overview</a></td>
                  <td><a href="../application.html">Application</a></td>
                  <td><strong><font color="#f2f2f2">SourceDoc</font></strong></td>
                </tr>
              </table>
            </section>
            <section id="downloads">
              <a class="zip_download_link" href="https://github.com/paolob67/pb.bank/zipball/master">Download this project as a .zip file</a>
              <a class="tar_download_link" href="https://github.com/paolob67/pb.bank/tarball/master">Download this project as a tar.gz file</a>
            </section>
        </header>
    </div>

    <!-- MAIN CONTENT -->
    <div id="main_content_wrap" class="outer">

      <section id="main_content" class="inner">
		<nav style="display: block; float: right; margin-left: 5px; margin-top: 28px; width: 200px; border-left: 1px solid #ccc;padding-left: 9px">
	    	<h2><a href="index.html">Index</a></h2><h3>Modules</h3><ul><li><a href="pb.module_Messages.html">Messages</a></li><li><a href="pb.module_wlInitOptions.html">wlInitOptions</a></li></ul><h3>Classes</h3><ul><li><a href="pb.bank.html">bank</a></li><li><a href="pb.bank.alerts.html">alerts</a></li><li><a href="pb.bank.DoubleStepAuthAdapter.html">DoubleStepAuthAdapter</a></li><li><a href="pb.bank.homeview.html">homeview</a></li><li><a href="pb.bank.MovementsAdapter.html">MovementsAdapter</a></li><li><a href="pb.bank.navigation.html">navigation</a></li><li><a href="pb.bank.navigation.ChallengeHandler.html">ChallengeHandler</a></li><li><a href="pb.bank.navigation.loginDialog.html">loginDialog</a></li><li><a href="pb.bank.navigation.loginpinDialog.html">loginpinDialog</a></li><li><a href="pb.bank.user.html">user</a></li></ul><h3>Namespaces</h3><ul><li><a href="pb.html">pb</a></li></ul>
		</nav>
 	  	
		<h3>Source: adapters/MovementsAdapter/MovementsAdapter-impl.js</h3>
		



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * Movements Adapter
 * @author Paolo Bianchini [paolo.bianchini@it.ibm.com]
 * @copyright IBM Corp. 2014
 */

/**
 * @description This adapter accesses a backend db to retrieve account movements
 * @class pb.bank.MovementsAdapter
 * @memberOf pb.bank
 */

/**
 * @description retrieves JSOn object listing account movements to list in view
 * @function getMovements
 * @memberOf pb.bank.MovementsAdapter
 * @param {string} account
 * @returns {object} json list of movements
 */
function getMovements() {
//400162854
	var path = "movements/_all_docs";
	
	var response;
	var i;
	var movements = [];
	
	var usrInfo = WL.Server.getActiveUser();
	
	var input = {
	    method : 'post',
	    returnedContentType : 'json',
	    path : path,
	    body : {
	    	content: {
	    		"selector" : { "accn" : usrInfo.attributes.accn }
	    	},
	    	contentType: "application/json"
	    }

	};
	
	response = WL.Server.invokeHttp(input);
	
	WL.Logger.debug(response);

	
	for (i = 0; i &lt; response.total_rows; i++ ) {
		
		var rowinput;
		var rowresult;
		
		rowinput = {
				method : 'get',
			    returnedContentType : 'json',
			    path : 'movements/' + response.rows[i].id
		};
		
		rowresult = WL.Server.invokeHttp(rowinput);
		
		/** @todo could use WL filters here */
		movements.push({
			bala : rowresult.bala,
			date : rowresult.date,
			desc : rowresult.desc,
			move : rowresult.move
		});

		WL.Logger.debug(movements);

	};
	
	return {
		
		movements: movements
	
	};
	
}</code></pre>
        </article>
    </section>





    	<br clear="both">
	  </section>
	<div>

    <!-- FOOTER  -->
    <div id="footer_wrap" class="outer">
      <footer class="inner">
    	<p>Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.3.0-dev</a> on Thu Nov 13 2014 11:18:04 GMT+0100 (CET)</p>
        <p class="copyright">pb.bank maintained by <a href="https://github.com/paolob67">paolob67</a></p>
        <p>Published with <a href="http://pages.github.com">GitHub Pages</a></p>
      </footer>
    </div>

<footer>
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
